<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:Easy2Do.ViewModels"
        xmlns:views="using:Easy2Do.Views"
        mc:Ignorable="d" d:DesignWidth="550" d:DesignHeight="550"
        x:Class="Easy2Do.Views.SettingsWindow"
        x:DataType="vm:SettingsViewModel"
        Title="Settings"
        Width="550" Height="550"
        WindowStartupLocation="CenterOwner"
        CanResize="False">

  <ScrollViewer Margin="20"
                VerticalScrollBarVisibility="Auto"
                HorizontalScrollBarVisibility="Disabled">
    <StackPanel Spacing="15">
      <TextBlock Text="Settings" 
                 FontSize="24" 
                 FontWeight="Bold"
                 Margin="0,0,0,10"/>

      <!-- Storage Location Section -->
      <Border BorderBrush="#FFCCCCCC" 
              BorderThickness="1" 
              CornerRadius="5"
              Padding="15"
              Background="#FFF9F9F9">
        <StackPanel Spacing="10">
          <TextBlock Text="Storage Location" 
                     FontSize="16" 
                     FontWeight="SemiBold"/>
          
          <TextBlock Text="Choose where your notes will be saved:"
                     FontSize="12"
                     Foreground="#FF666666"
                     TextWrapping="Wrap"/>
          
          <Border BorderBrush="#FFAAAAAA" 
                  BorderThickness="1" 
                  CornerRadius="3"
                  Padding="8"
                  Background="White">
            <TextBlock Text="{Binding StorageLocation}" 
                       FontSize="12"
                       TextWrapping="Wrap"
                       Foreground="#FF333333"/>
          </Border>
          
          <StackPanel Orientation="Horizontal" Spacing="10">
            <Button Content="Browse..." 
                    Command="{Binding BrowseStorageLocationCommand}"
                    Padding="15,8"
                    Background="#FF4CAF50"
                    Foreground="White"
                    CornerRadius="5"/>
            
            <Button Content="Open Folder" 
                    Command="{Binding OpenStorageFolderCommand}"
                    Padding="15,8"
                    Background="#FFFF9800"
                    Foreground="White"
                    CornerRadius="5"/>
            
            <Button Content="Restore Backup"
                    Command="{Binding RestoreBackupCommand}"
                    IsEnabled="True"
                    Padding="15,8"
                    Background="#FFD32F2F"
                    Foreground="White"
                    CornerRadius="5"/>
          </StackPanel>
          
          <TextBlock Text="Note: Changing the storage location will not move existing notes."
                     FontSize="11"
                     Foreground="#FFFF6600"
                     FontStyle="Italic"
                     TextWrapping="Wrap"/>
        </StackPanel>
      </Border>

      <Border BorderBrush="#FFCCCCCC"
              BorderThickness="1"
              CornerRadius="5"
              Padding="15"
              Background="#FFF9F9F9">
        <StackPanel Spacing="10">
          <TextBlock Text="Sync (PowerSync)"
                     FontSize="16"
                     FontWeight="SemiBold"/>

          <CheckBox Content="Enable sync"
                    IsChecked="{Binding SyncEnabled}"/>

          <TextBlock Text="PowerSync URL"
                     FontSize="12"
                     Foreground="#FF666666"/>
          <TextBox Text="{Binding PowerSyncUrl}"
                   Watermark="https://your-powersync-url"
                   FontSize="12"/>

          <TextBlock Text="PowerSync dev token (development only)"
                     FontSize="12"
                     Foreground="#FF666666"/>
          <TextBox Text="{Binding PowerSyncDevToken}"
                   Watermark="dev token"
                   FontSize="12"
                   PasswordChar="*"/>

          <TextBlock Text="Backend URL (for upload + prod auth)"
                     FontSize="12"
                     Foreground="#FF666666"/>
          <TextBox Text="{Binding SyncBackendUrl}"
                   Watermark="https://your-backend"
                   FontSize="12"/>

          <TextBlock Text="Supabase URL (direct upload, dev only)"
                     FontSize="12"
                     Foreground="#FF666666"/>
          <TextBox Text="{Binding SupabaseUrl}"
                   Watermark="https://your-project.supabase.co"
                   FontSize="12"/>

          <TextBlock Text="Supabase API key (anon or service role)"
                     FontSize="12"
                     Foreground="#FF666666"/>
          <TextBox Text="{Binding SupabaseApiKey}"
                   Watermark="supabase key"
                   FontSize="12"
                   PasswordChar="*"/>

          <StackPanel Orientation="Horizontal" Spacing="10">
            <Button Content="Reconnect"
                    Command="{Binding ReconnectSyncCommand}"
                    Padding="15,8"
                    Background="#FF607D8B"
                    Foreground="White"
                    CornerRadius="5"/>
          </StackPanel>

        </StackPanel>
      </Border>

      <Border BorderBrush="#FFCCCCCC" 
              BorderThickness="1" 
              CornerRadius="5"
              Padding="15"
              Background="#FFF9F9F9">
        <StackPanel Spacing="10">
          <Button Content="About Easy2Do" 
                  Command="{Binding ShowAboutCommand}"
                  HorizontalAlignment="Left"
                  Padding="20,10"
                  Background="#FF2196F3"
                  Foreground="White"
                  CornerRadius="5"/>
          
          <TextBlock Text="View information about this application"
                     FontSize="12"
                     Foreground="#FF666666"/>
        </StackPanel>
      </Border>

      <!-- About Section (shown when About is clicked) -->
      <Border IsVisible="{Binding IsAboutVisible}"
              BorderBrush="#FF2196F3" 
              BorderThickness="2" 
              CornerRadius="5"
              Padding="20"
              Background="White">
        <views:AboutView />
      </Border>
    </StackPanel>
  </ScrollViewer>
</Window>
